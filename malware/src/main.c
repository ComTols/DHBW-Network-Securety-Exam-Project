#include <stdio.h>
#include <stdlib.h>

// Verhindere, dass Cygwin die POSIX-Header verwendet
#define WIN32_LEAN_AND_MEAN  // Verhindert, dass unnötige Windows-Header eingebunden werden
#include <winsock2.h>        // Windows-spezifische Netzwerkfunktionen
#include <windows.h>         // Standard Windows-Funktionen
#include <pcap.h>            // Npcap für das Packet Capturing


int main() {
    //insert path to file
    FILE *file = fopen("C:\\Users\\lukas\\CLionProjects\\DHBW-Network-Securety-Exam-Project\\malware\\src\\important.txt", "rb");
    if (file == NULL) {
        perror("File opening error");
        return 1;
    }

    //get file size
    fseek(file, 0, SEEK_END);
    long file_size = ftell(file);
    rewind(file);

    //alloc memory for file
    unsigned char *buffer = (unsigned char *)malloc(file_size + 1);
    if (buffer == NULL) {
        perror("Memory allocation error");
        fclose(file);
        return 1;
    }

    //read file into buffer
    size_t bytes_read = fread(buffer, 1, file_size, file);
    if (bytes_read != file_size) {
        perror("File reading error");
        free(buffer);
        fclose(file);
        return 1;
    }

    buffer[file_size] = '\0';

    fclose(file);

    //get utf8-bytes in hex
    for (size_t i = 0; i < bytes_read; i++) {
        printf("%02x ", buffer[i]);
    }
    printf("\n");

    free(buffer);

    return 0;
}